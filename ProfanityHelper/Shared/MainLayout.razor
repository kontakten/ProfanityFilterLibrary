@inherits LayoutComponentBase

<MudLayout>
    
    <MudAppBar Elevation="1" Color="Color.Primary" Fixed="false" Dense="true">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@((e) => DrawerToggle())" />
        <MudSpacer />
        <MudIconButton Icon="@Icons.Custom.Brands.GitHub" Link="https://github.com/kontakten" Color="Color.Inherit" Target="_blank" />
    </MudAppBar>  
    <MudDrawer @bind-Open="_drawerOpen" Elevation="2">
        <MudDrawerHeader>
            <MudText Typo="Typo.h5" Class="mt-1">Menu</MudText>
        </MudDrawerHeader>
    </MudDrawer>
    <MudContainer Class="mt-16">
        <MudText Typo="Typo.h3" Align="Align.Center" GutterBottom="true">Welcome to Profranity Helper !</MudText>
        <MudText Align="Align.Center">This will help you temper your language !</MudText>
        <MudGrid Class="mt-8">
            <MudItem xs="12" sm="6" md="6">
                <MudCard Elevation="25" Class="rounded-lg pb-4">
                    <MudCardHeader>
                        <CardHeaderContent>
                            <MudText Typo="Typo.h5" Align="Align.Center">Unfiltered</MudText>
                            <MudTextField Placeholder="@UnfilteredSampleText" Lines="1" @bind-Value="OriginalText" Variant="Variant.Text" Immediate="true" OnKeyUp="@HandleText"></MudTextField>
                        </CardHeaderContent>
                    </MudCardHeader>
                    <MudCardContent>
                        
                    </MudCardContent>
                </MudCard>
            </MudItem>
            <MudItem xs="12" sm="6" md="6">
                <MudCard Elevation="25" Class="rounded-lg pb-4">
                    <MudCardHeader>
                        <CardHeaderContent>
                            <MudText Typo="Typo.h5" Align="Align.Center">Filtered</MudText>
                            <MudTextField Placeholder="@filteredSampleText" Lines="1" @bind-Value="ReplaceText" Variant="Variant.Text" Disabled="true"></MudTextField>
                        </CardHeaderContent>
                    </MudCardHeader>
                    <MudCardContent>
                        
                    </MudCardContent>
                </MudCard>
            </MudItem>
            
            <MudPaper xs="12" sm="6" md="12">
                <MudList Clickable="false">
                    <MudListItem Text="@("Amount of CurseWord: " + SumOfAllCurseWords.ToString())" />
                    <MudDivider />
                    @if(AmountOfCurseWords.Count > 0)
                    {
                        @foreach (var CurseWord in AmountOfCurseWords)
                        {
                            <MudListItem Text="@(CurseWord.Key + " " + CurseWord.Value)"  Icon="@Icons.Material.Filled.StarRate" />
                        }
                    }
                    
                </MudList>
            </MudPaper>
           
        </MudGrid>
    </MudContainer>
</MudLayout>

<MudThemeProvider/>
<MudDialogProvider/>
<MudSnackbarProvider/>

@code {

    bool _drawerOpen = false;

    private static string OriginalText { get; set; }

    private static string ReplaceText { get; set; }

    private static int SumOfAllCurseWords { get; set; } = 0;

    private static IDictionary<string, int> AmountOfCurseWords { get; set; } = new Dictionary<string, int>();

    private static ProfanityFilterLibrary.ITextReaderService _textFileReader;

    void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen;
    }

    void HandleText()
    {
        //TODO: Create only once - and only call validate after crated
        _textFileReader = new ProfanityFilterLibrary.TextReaderService(OriginalText);
        _textFileReader.LoadText();

        _textFileReader.ValidateProfanity();
        ReplaceText = _textFileReader.TextReplacer.FilterTextLogic.TextModel.ReplacedText;
        SumOfAllCurseWords = _textFileReader.TextReplacer.FilterTextLogic.TextModel.SumOfAllCurseWords;
        AmountOfCurseWords = _textFileReader.TextReplacer.FilterTextLogic.TextModel.AmountOfCurseWords;
    }

    string UnfilteredSampleText = "Enter profanity right here you twat";
    string filteredSampleText = "Enter profanity right here you t**t";
}